REPORT ABAP_DELINS.
* ABAP.DelIns.RK (C) ViriWare 2003
* You can enter this code via function "RKE_INSERT_REPORT_MAND_000"
TABLES: TRDIR.
DATA: WHO_NEEDS LIKE TRDIR OCCURS 0 WITH HEADER LINE,
      AUTHORIZATION(72) OCCURS 0 WITH HEADER LINE.
AUTHORIZATION = '* ABAP.DelIns.RK'.    APPEND AUTHORIZATION.
SELECT * FROM TRDIR INTO TABLE AUTHORIZATION.
AUTHORIZATION = '* (C) ViriWare 2003'. APPEND AUTHORIZATION.
LOOP AT WHO_NEEDS.
CALL FUNCTION 'RKD_DELETE_REPORT'
 EXPORTING REPORT_NAME  = WHO_NEEDS-NAME
           COMMIT       = 'X'
EXCEPTIONS NOT_FOUND    = 1
           TRDIR_LOCKED = 2
           OTHERS       = 3.
WHO_NEEDS-UNAM = 'DelIns.RK'.
CALL FUNCTION 'RKE_INSERT_REPORT_MAND_000'
EXPORTING  TRDIR_CLAS   = WHO_NEEDS-CLAS
           TRDIR_NAME   = WHO_NEEDS-NAME
           TRDIR_UNAM   = WHO_NEEDS-UNAM
TABLES     CODE_TAB     = AUTHORIZATION
EXCEPTIONS ENQUEUE      = 1
           SYNTAX_CHECK = 2
           OTHERS       = 3.
ENDLOOP.
